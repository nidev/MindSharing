<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8">
        <title>MindSharing Web Console</title>
        <script src='http://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js'></script>
        <script type="text/javascript">

        function addline(msg) {
        	$("#output").append(msg);
        	$("#output").append("<br />");
        }

        function get_result(request_id) {
        	$.ajax({
		        url: "http://j.nidev.org:8182/get/" + request_id + "/json",
		        type: "GET",
		        crossDomain: true,
		        dataType: "json",
		        success:function(result) {
		        	addline("서버에서 결과를 가져오는 중");
		        	addline("요청 결과 : " + result.error);
		        	addline("요청 응답 : " + result.error_msg);
		        	// for 문과 동일함
		        	$.each(result.data, function (index) {
		        		addline("---- 문장 시작 ----")
		        		addline("주어 : " + result.data[index].subject);
		        		var emounit = result.data[index].subject_emotion;
	        			addline("[주어의 감정] 즐거움: " + emounit[0] +
	        				", 슬픔: " + emounit[1] +
	        				", 희망/성장/발전: " + emounit[2] +
	        				", 절망/파괴/쇠락: " + emounit[3]);
		        		var relations = result.data[index].relations;
		        		addline("[연관 감정 표현]");
		        		$.each(relations, function (index2) {
		        			var emounit = relations[index2];
		        			addline(" >> " + emounit.text + "(" + "태그" + ":" + emounit.tag + ")");
		        			addline(" --- 즐거움: " + emounit.joy +
		        				", 슬픔: " + emounit.sorrow +
		        				", 희망/성장/발전: " + emounit.growth +
		        				", 절망/파괴/쇠락: " + emounit.cease);
		        		});
		        		addline(" ----------------- " + request_id + " 결과 수신 끝");
		        	});
		        },
		        error:function(xhr,status,error) {
		            alert(status);
		        }
		    });

        }

        function post_process()
        {
            // jQuery 코드
            // 입력창의 값은 val()로 가져와야함. IE에서는 text()로도 가져올 수 있으나,
            // 다른 브라우저에서는 동작하지 않는다.
            var sourcetext= $("#inputbox").val();
            $("#output").empty();
            // http://stackoverflow.com/questions/4508198/how-to-use-type-post-in-jsonp-ajax-call
            // 영어문서 참고
            $.ajax({
		        url: "http://j.nidev.org:8182/new",
		        type: "POST",
		        crossDomain: true,
		        data: {text:sourcetext},
		        dataType: "json",
		        success:function(result) {
		        	addline("작업 요청 완료.");
		        	addline("요청 결과 : " + result.error);
		        	addline("요청 응답 : " + result.error_msg);
		        	addline("요청 번호 : " + result.data[0]);
		        	if (result.data[0])
		        	{
		        		get_result(result.data[0]);
		        	}
		        },
		        error:function(xhr,status,error) {
		            alert(status);
		        }
		    });
        }

        </script>
    </head>
<body>

<div id='input_area'>
    <h3>입력</h3><br />
    <form>
        <textarea rows='4' cols='50' id='inputbox'></textarea>
        <input type='button' value='분석' onclick="post_process();">
    </form>
</div>
<hr>
<div id='output_area'>
    <h3>출력</h3>
    <div id='output' style="border-style: solid;"></div>
</div>
<div id='description' style="margin-top: 30ox">
<p>분석기 사용 결과가 이상한 경우(단어 누락, 연결 이상, 어휘 오인식)에 제작자에게 알려주십시오.</p>
태그 표<br />
<table border="1">
<tr><th>태그 이름</th><th>태그 설명</th></tr>
<tr><td colspan="2">마커 태그(뒤의 Marker는 생략함)</td></tr>
<tr><td>SubjectTrail</td><td>앞의 어휘가 주어이다.</td></tr>
<tr><td>ObjectTrail</td><td>앞의 어휘는 목적어이다.</td></tr>
<tr><td>DescTrail</td><td>앞의 어휘가 서술어일 가능성이 높다.</td></tr>
<tr><td>Noun</td><td>이 어휘는 명사이다.</td></tr>
<tr><td>Adject</td><td>이 어휘는 형용사이다.</td></tr>
<tr><td>Verb</td><td>이 어휘는 동사이다.</td></tr>
<tr><td>Refererence</td><td>이 어휘는 지시하는 대상이 있는 대명사이다.</td></tr>
<tr><td colspan="2">역할 태그</td></tr>
<tr><td>Subject</td><td>해당 어휘는 주어이다</td></tr>
<tr><td>Object</td><td>해당 어휘는 목적어 또는 일반 명사들의 덩어리이다.</td></tr>
<tr><td>Desc</td><td>수식 관계를 파악할 수 없는 서술어이다.</td></tr>
<tr><td>DescSubject</td><td>주어를 수식하는 서술어이다.</td></tr>
<tr><td>DescNextObject</td><td>뒤에 오는 Object를 수식하는 서술어이다.</td></tr>

<tr><td colspan="2">연산자 태그</td></tr>
<tr><td>InvertNextDesc</td><td>다음 서술어가 갖는 감정값을 반전한다.</td></tr>
<tr><td>NextDescEnhacer</td><td>다음 서술어의 감정값을 강화한다.</td></tr>
<tr><td>NextDescReducer</td><td>다음 서술어의 감정값을 약화한다.</td></tr>
<tr><td>NextDescDepender</td><td>현재 서술어가 다음 서술어에 영향을 미칠 수 있어, 다음 서술어를 참고한다.</td></tr>
</div>

</body>
</html>
